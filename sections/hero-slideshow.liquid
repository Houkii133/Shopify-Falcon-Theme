{% comment %}
  Â© 2025 KondaSoft
  https://www.kondasoft.com
{% endcomment %}

{% if section.index <= 3 or request.design_mode %}
  <link href="{{ 'hero-slideshow.css' | asset_url }}" rel="stylesheet" fetchpriority="high">
{% endif %}

<div
  id="hero-slideshow-{{ section.id }}"
  class="hero-slideshow {{ section.settings.color_scheme | prepend: 'color-' }}"
  style="
    {% unless section.settings.height_mobile == blank %}
      --height-mobile: {{ section.settings.height_mobile | append: 'px' }};
    {% endunless %}
     {% unless section.settings.height_desktop == blank %}
      --height-desktop: {{ section.settings.height_desktop | append: 'px' }};
    {% endunless %}
    --padding-top: {{ section.settings.padding_top | append: 'rem' }};
    --padding-bottom: {{ section.settings.padding_bottom | append: 'rem' }};
  "
  data-section-css="{{ 'hero-slideshow.css' | asset_url }}"
>
  <div class="{% unless section.settings.full_width %}container {% endunless %}">
    <slideshow-component
      class="slideshow"
      style="
        --speed: {{ section.settings.speed | append: 'ms' }};
        --interval: {{ section.settings.autoplay | append: 's' }};
      "
      data-controls-style="{{ section.settings.controls_style }}"
      data-autoplay="{{ section.settings.autoplay }}"
      data-autoplay-stopped="false"
      data-zoom-effect="{{ section.settings.zoom_effect }}"
      data-section-id="{{ section.id }}"
      role="region"
      aria-label="{{ section.settings.label }}"
      aria-roledescription="{{ 'accessibility.slideshow' | t | downcase }}"
    >
      {% if section.settings.controls and section.blocks.size > 1 %}
        <button
          class="slideshow-control"
          name="previous"
          type="button"
          aria-label="{{ 'accessibility.previous_slide' | t }}"
        >
          {% render 'svg-icons', icon: 'chevron-left', stroke_width: 1.5, size: 24 %}
        </button>
      {% endif %}
      <div
        class="slideshow-track"
        aria-live="polite"
        aria-atomic="true"
      >
        {% for block in section.blocks %}
          {% liquid
            if section.index > 1 or forloop.index > 1
              assign loading = 'lazy'
              assign fetchpriority = 'low'
            else
              assign loading = 'eager'
              assign fetchpriority = 'high'
            endif
          %}
          <div
            id="slideshow-slide-{{ block.id }}"
            class="slideshow-slide {% if forloop.first %}active{% endif %}"
            style="
              --overlay-color: {{ block.settings.overlay_color | color_to_rgb | remove: 'rgb(' | remove: ')'  }};
              --overlay-opacity: {{ block.settings.overlay_opacity | append: '%' }};
              --overlay-blur: {{ block.settings.overlay_blur | append: 'px' }};
            "
            data-index="{{ forloop.index0 }}"
            data-overlay-opacity="{{ block.settings.overlay_opacity }}"
            role="group"
            aria-roledescription="{{ 'accessibility.slide' | t | downcase }}"
            aria-label="{{ 'accessibility.slide_of_total' | t: slide: forloop.index, total: forloop.length }}"
            tabindex="-1"
            {{ block.shopify_attributes }}
          >
            {% if block.settings.video != null %}
              <div 
                class="video-wrapper"
                data-viewport-entered="false"
                data-video-autoplay="true">
                {{-
                  block.settings.video | video_tag:
                    image_size: '1600x', 
                    autoplay: false, 
                    loop: true, 
                    muted: true, 
                    controls: false,
                    loading: loading,
                    preload: 'none',
                    fetchpriority: fetchpriority
                -}}
              </div>
            {% elsif block.settings.img != null %}
              <picture>
                {% if block.settings.img_mobile == blank %}
                  <source
                    media="(max-width: 599px)"
                    srcset="{{ block.settings.img | image_url: width: 800 }}"
                    sizes="100vw"
                  >
                  {% else %}
                    <source
                      media="(max-width: 599px)"
                      srcset="{{ block.settings.img_mobile | image_url: width: 800 }}"
                      sizes="100vw"
                    >
                  {% endif %}
                <img
                  src="{{ block.settings.img | image_url: width: 1600 }}"
                  sizes="100vw"
                  alt="{{ block.settings.img.alt }}"
                  width="1600"
                  height="{{ 1600 | divided_by: block.settings.img.aspect_ratio | round }}"
                  loading="{{ loading }}"
                  fetchpriority="{{ fetchpriority }}"
                >
              </picture>
            {% else %}
              {% capture current %}{% cycle 1, 2, 3 %}{% endcapture %}
              {{ 'hero-apparel-' | append: current | placeholder_svg_tag: 'placeholder-svg' }}
            {% endif %}
            {% unless block.settings.heading == blank and block.settings.description == blank %}
              <div
                class="slideshow-slide-content"
                data-position-mobile="{{ block.settings.position_mobile }}"
                data-position-desktop="{{ block.settings.position_desktop }}"
              >
                <div class="container">
                  <div class="slideshow-slide-content-inner">
                    {% unless block.settings.subheading == blank %}
                      <div class="subheading">
                        {{ block.settings.subheading }}
                      </div>
                    {% endunless %}
                    {% unless block.settings.heading == blank %}
                      <h2 class="heading {{ block.settings.heading_size }}">
                        {{ block.settings.heading }}
                      </h2>
                    {% endunless %}
                    {% unless block.settings.description == blank %}
                      <div class="description rte {{ block.settings.description_font_size }}">
                        {{ block.settings.description }}
                      </div>
                    {% endunless %}
                    {% if block.settings.btn_primary_text != blank or block.settings.btn_secondary_text != blank %}
                      <div class="btn-wrapper">
                        {% unless block.settings.btn_primary_text == blank %}
                          <a
                            class="btn {{ block.settings.btn_primary_style }}"
                            href="{{ block.settings.btn_primary_url }}"
                          >
                            {{ block.settings.btn_primary_text }}
                          </a>
                        {% endunless %}
                        {% unless block.settings.btn_secondary_text == blank %}
                          <a
                            class="btn {{ block.settings.btn_secondary_style }}"
                            href="{{ block.settings.btn_secondary_url }}"
                          >
                            {{ block.settings.btn_secondary_text }}
                          </a>
                        {% endunless %}
                      </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            {% endunless %}
          </div>
        {% endfor %}
      </div>
      {% if section.settings.controls and section.blocks.size > 1 %}
        <button
          class="slideshow-control"
          name="next"
          type="button"
          aria-label="{{ 'accessibility.next_slide' | t }}"
        >
          {% render 'svg-icons', icon: 'chevron-right', stroke_width: 1.5, size: 24 %}
        </button>
      {% endif %}
      {% if section.blocks.size > 1 and section.settings.pagination == 'dots' %}
        <div class="slideshow-pagination" data-pagination-type="dots">
          {% for block in section.blocks %}
            <button
              class="{% if forloop.first %}active{% endif %}"
              type="button"
              aria-label="{{ 'accessibility.slide_go_to' | t: slide: forloop.index }}"
            ></button>
          {% endfor %}
        </div>
      {% elsif section.blocks.size > 1 and section.settings.pagination == 'fraction' %}
        <div class="slideshow-pagination" data-pagination-type="fraction">
          <span>1 / {{ section.blocks.size }}</span>
        </div>
      {% endif %}
    </slideshow-component>
  </div>
</div>

{% schema %}
{
  "name": "Hero slideshow",
  "tag": "section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-3"
    },
    {
      "type": "checkbox",
      "id": "controls",
      "label": "Show Controls",
      "info": "Prev/Next buttons",
      "default": true
    },
    {
      "type": "select",
      "id": "controls_style",
      "label": "Controls style",
      "options": [
        { "value": "minimal", "label": "Minimal" },
        { "value": "outline", "label": "Outline" },
        { "value": "inverted", "label": "Inverted" },
        { "value": "accent", "label": "Accent" }
      ],
      "default": "outline"
    },
    {
      "type": "select",
      "id": "pagination",
      "label": "Pagination",
      "info": "Bottom pagination",
      "options": [
        { "value": "dots", "label": "Dots" },
        { "value": "fraction", "label": "Fraction" },
        { "value": "none", "label": "None" }
      ],
      "default": "dots"
    },
    {
      "type": "range",
      "id": "speed",
      "label": "Speed",
      "info": "Transition between slides",
      "min": 0,
      "max": 2000,
      "step": 100,
      "default": 500,
      "unit": "ms"
    },
    {
      "type": "range",
      "id": "autoplay",
      "label": "Autoplay",
      "min": 0,
      "max": 10,
      "default": 5,
      "unit": "sec",
      "info": "Choose \"0\" to disable autoplay"
    },
    {
      "type": "checkbox",
      "id": "zoom_effect",
      "label": "Zoom effect",
      "default": true
    },
    {
      "type": "text",
      "id": "height_mobile",
      "label": "Mobile height (px)",
      "info": "Leave empty to adapt on mobile",
      "default": "500"
    },
    {
      "type": "text",
      "id": "height_desktop",
      "label": "Desktop height (px)",
      "info": "Leave empty to adapt on desktop",
      "default": "700"
    },
    {
      "type": "checkbox",
      "id": "full_width",
      "label": "Full width",
      "default": true
    },
    {
      "type": "text",
      "id": "label",
      "label": "Label",
      "default": "Promotional slideshow",
      "info": "It is needed for accessibility purposes."
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Top",
      "min": 0,
      "max": 5,
      "step": 0.2,
      "default": 0,
      "unit": "rem"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Bottom",
      "min": 0,
      "max": 5,
      "step": 0.2,
      "default": 0,
      "unit": "rem"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "header",
          "content": "Image",
        },
        {
          "type": "image_picker",
          "id": "img",
          "label": "Image"
        },
        {
          "type": "image_picker",
          "id": "img_mobile",
          "label": "Mobile image",
          "info": "Optional, leave empty to use one image for all devices",
        },
        {
          "type": "header",
          "content": "Video",
          "info": "NOTE: Either image or video can be used, not both."
        },
        {
          "type": "video",
          "id": "video",
          "label": "Video" 
        },
        {
          "type": "header",
          "content": "Media overlay"
        },
        {
          "type": "color",
          "id": "overlay_color",
          "label": "Overlay color",
          "default": "#000000"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "Opacity",
          "min": 0,
          "max": 100,
          "step": 10,
          "default": 30,
          "unit": "%"
        },
        {
          "type": "range",
          "id": "overlay_blur",
          "label": "Blur",
          "min": 0,
          "max": 10,
          "step": 1,
          "default": 0
        },
        {
          "type": "header",
          "content": "Content"
        },
        {
          "type": "select",
          "id": "position_mobile",
          "label": "Position - mobile",
          "default": "center",
          "options": [
            { "value": "top", "label": "Top" },
            { "value": "center", "label": "Center" },
            { "value": "bottom", "label": "Bottom" }
          ]
        },
        {
          "type": "select",
          "id": "position_desktop",
          "label": "Position - desktop",
          "default": "center",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" },
            { "value": "bottom", "label": "Bottom" }
          ]
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Subheading",
          "default": "Slide subheading"
        },
        {
          "type": "inline_richtext",
          "id": "heading",
          "label": "Heading",
          "default": "Slide heading"
        },
        {
          "type": "select",
          "id": "heading_size",
          "label": "Heading size",
          "default": "h1",
          "options": [
            { "value": "h1", "label": "H1" },
            { "value": "h2", "label": "H2" },
            { "value": "h3", "label": "H3" },
            { "value": "h4", "label": "H4" },
            { "value": "h5", "label": "H5" },
            { "value": "h6", "label": "H6" }
          ]
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description",
          "default": "<p>An optional description for this slide</p>"
        },
        {
          "type": "select",
          "id": "description_size",
          "label": "Description font-size",
          "default": "fs-lg",
          "options": [
            { "value": "fs-sm", "label": "sm" },
            { "value": "fs-md", "label": "md" },
            { "value": "fs-lg", "label": "lg" },
            { "value": "fs-xl", "label": "xl" }
          ]
        },
        {
          "type": "header",
          "content": "Primary button"
        },
        {
          "type": "text",
          "id": "btn_primary_text",
          "label": "Button text",
          "default": "Primary button",
          "info": "Leave empty to disable"
        },
        {
          "type": "select",
          "id": "btn_primary_style",
          "label": "Button style",
          "default": "btn-primary",
          "options": [
            { "value": "btn-primary", "label": "Primary" },
            { "value": "btn-outline", "label": "Outline" },
            { "value": "btn-accent", "label": "Accent" },
            { "value": "btn-link", "label": "Link" }
          ]
        },
        {
          "type": "url",
          "id": "btn_primary_url",
          "label": "Button URL"
        },
        {
          "type": "header",
          "content": "Secondary button"
        },
        {
          "type": "text",
          "id": "btn_secondary_text",
          "label": "Button text",
          "default": "Secondary button",
          "info": "Leave empty to disable"
        },
        {
          "type": "select",
          "id": "btn_secondary_style",
          "label": "Button style",
          "default": "btn-outline",
          "options": [
            { "value": "btn-primary", "label": "Primary" },
            { "value": "btn-outline", "label": "Outline" },
            { "value": "btn-accent", "label": "Accent" },
            { "value": "btn-link", "label": "Link" }
          ]
        },
        {
          "type": "url",
          "id": "btn_secondary_url",
          "label": "Button URL"
        }
      ]
    }
  ],
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "presets": [
    {
      "name": "Hero slideshow",
      "category": "Image/Video",
      "blocks": [{ "type": "slide" }, { "type": "slide" }, { "type": "slide" }]
    }
  ]
}
{% endschema %}
